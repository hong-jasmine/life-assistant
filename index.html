<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>âš¡ æ¥µé€Ÿå¡ç‰‡.Flash cards - è¨˜å¸³èˆ‡å¾…è¾¦</title>
    <meta name="description" content="åŠŸèƒ½å®Œæ•´çš„å€‹äººè²¡å‹™èˆ‡ä»»å‹™ç®¡ç†å·¥å…·ï¼Œæ”¯æ´æ”¶æ”¯åˆ†é¡ã€åœ–è¡¨çµ±è¨ˆã€æ•¸æ“šåŒ¯å…¥åŒ¯å‡ºåŠæ·±è‰²æ¨¡å¼">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>

<body class="min-h-screen p-4 md:p-8">

    <!-- æ·±è‰²æ¨¡å¼åˆ‡æ›æŒ‰éˆ• -->
    <button onclick="toggleTheme()" class="theme-toggle btn-hover" id="theme-toggle-btn" title="åˆ‡æ›æˆæ·±è‰²æ¨¡å¼">
        <span id="theme-icon" class="text-2xl">ğŸŒ™</span>
    </button>

    <!-- å´é‚Šæ¬„å±•é–‹æŒ‰éˆ•ï¼ˆå›ºå®šï¼‰ -->
    <button onclick="toggleSidebar()" class="sidebar-open-btn btn-hover" id="sidebar-open-btn" title="å±•é–‹å´é‚Šæ¬„">
        <span class="text-2xl">â˜°</span>
    </button>


    <!-- å´é‚Šæ¬„ -->
    <div id="sidebar" class="sidebar">
        <div class="sidebar-header">
            <h3>å¸³æˆ¶ç¸½è¦½</h3>
            <button id="sidebar-toggle" class="sidebar-toggle" onclick="toggleSidebar()">
                <span id="sidebar-toggle-icon">â˜°</span>
            </button>
        </div>

        <!-- ä¸»é é¢æŒ‰éˆ• -->
        <button class="sidebar-item sidebar-home active" onclick="switchToHome()">
            <span class="sidebar-icon">ğŸ </span>
            <div style="flex: 1;">
                <div class="sidebar-name">ä¸»é é¢</div>
                <div id="home-total-balance" class="sidebar-balance">$0.00</div>
                <div id="home-todo-count" class="sidebar-todo-count">0 å€‹å¾…è¾¦</div>
            </div>
        </button>

        <!-- å¸³æˆ¶åˆ—è¡¨ -->
        <div class="sidebar-accounts" id="sidebar-accounts">
            <!-- å‹•æ…‹ç”Ÿæˆ -->
        </div>
    </div>

    <!-- å´é‚Šæ¬„é®ç½©ï¼ˆæ‰‹æ©Ÿç‰ˆï¼‰ -->
    <div id="sidebar-overlay" class="sidebar-overlay" onclick="closeSidebar()"></div>
    <div id="main-content" class="main-content max-w-7xl mx-auto">
        <h1 class="text-5xl font-bold text-center mb-2">âš¡ æ¥µé€Ÿå¡ç‰‡.Flash cards</h1>
        <p class="text-center text-xl font-semibold text-gray-600 dark:text-gray-300 mb-8">è¨˜å¸³ + å¾…è¾¦ + çµ±è¨ˆåˆ†æ</p>

        <!-- çµ±è¨ˆæ‘˜è¦ -->
        <!-- æˆå°±é‡Œç¨‹ç¢‘å€å¡Š -->
        <div id="achievement-section" class="achievement-banner mb-6">
            <div class="achievement-content">
                <!-- ç«ç®­åœ–ç¤º -->
                <div class="rocket-container">
                    <span id="rocket-icon" class="rocket">ğŸš€</span>
                </div>

                <!-- æ‹‹ç‰©ç·šè»Œè·¡ -->
                <div class="trajectory-container">
                    <svg class="trajectory-svg" viewBox="0 0 400 60">
                        <path id="trajectory-path" d="M 0 50 Q 100 10, 200 30 T 400 50" fill="none"
                            stroke="url(#gradient)" stroke-width="2" stroke-dasharray="5,5" />
                        <defs>
                            <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" style="stop-color:#a78bfa;stop-opacity:0.3" />
                                <stop offset="100%" style="stop-color:#60a5fa;stop-opacity:0.8" />
                            </linearGradient>
                        </defs>
                    </svg>
                    <!-- é€²åº¦æ˜Ÿæ˜Ÿ -->
                    <div id="progress-stars" class="progress-stars"></div>
                </div>

                <!-- æˆå°±è³‡è¨Š -->
                <div class="achievement-info">
                    <div class="streak-display">
                        <span class="streak-icon">ğŸ”¥</span>
                        <span id="streak-days" class="streak-text">0 å¤©</span>
                    </div>
                    <div class="points-display">
                        <span class="points-icon">â­</span>
                        <span id="total-points" class="points-text">0 ç©åˆ†</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
            <div class="card stat-card rounded-xl shadow-md p-6 text-center">
                <div class="text-base font-semibold text-gray-700 dark:text-gray-300">ç¸½æ”¶å…¥</div>
                <div id="total-income" class="stat-value text-3xl font-bold text-green-600 mt-2">$0</div>
            </div>
            <div class="card stat-card rounded-xl shadow-md p-6 text-center">
                <div class="text-base font-semibold text-gray-700 dark:text-gray-300">ç¸½æ”¯å‡º</div>
                <div id="total-expense" class="stat-value text-3xl font-bold text-red-600 mt-2">$0</div>
            </div>
            <div class="card stat-card rounded-xl shadow-md p-6 text-center">
                <div class="text-base font-semibold text-gray-700 dark:text-gray-300">æ·¨é¤˜é¡</div>
                <div id="balance" class="stat-value text-3xl font-bold mt-2">$0</div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">

            <!-- è¨˜å¸³å€åŸŸ -->
            <div class="space-y-6">
                <div class="card rounded-xl shadow-md p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-2xl font-semibold text-blue-600 dark:text-blue-400">ğŸ’° è¨˜å¸³ç®¡ç†</h2>
                        <div class="flex gap-2">
                            <button onclick="showAccountManager()"
                                class="bg-purple-500 text-white px-3 py-1 rounded text-sm hover:bg-purple-600 btn-hover"
                                title="ç®¡ç†å¸³æˆ¶">
                                ğŸ¦
                            </button>
                            <button onclick="showTransferModal()"
                                class="bg-orange-500 text-white px-3 py-1 rounded text-sm hover:bg-orange-600 btn-hover"
                                title="è½‰å¸³">
                                ğŸ’¸
                            </button>
                        </div>
                    </div>
                    <!-- æ–°å¢è¨˜éŒ„è¡¨å–® -->
                    <div class="space-y-3 mb-6">
                        <div class="grid grid-cols-2 gap-3">
                            <select id="transaction-type" onchange="updateCategories()" class="border p-2 rounded">
                                <option value="expense">æ”¯å‡º</option>
                                <option value="income">æ”¶å…¥</option>
                            </select>
                            <div class="flex gap-2">
                                <select id="transaction-category" class="border p-2 rounded flex-1">
                                    <option value="é£Ÿç‰©">é£Ÿç‰©</option>
                                    <option value="äº¤é€š">äº¤é€š</option>
                                    <option value="å¨›æ¨‚">å¨›æ¨‚</option>
                                    <option value="è³¼ç‰©">è³¼ç‰©</option>
                                    <option value="é†«ç™‚">é†«ç™‚</option>
                                    <option value="æ•™è‚²">æ•™è‚²</option>
                                    <option value="å…¶ä»–">å…¶ä»–</option>
                                </select>
                                <button onclick="showCategoryManager()"
                                    class="bg-purple-500 text-white px-3 rounded hover:bg-purple-600 btn-hover"
                                    title="ç®¡ç†é¡åˆ¥">
                                    âš™ï¸
                                </button>
                            </div>
                        </div>
                        <input id="transaction-name" type="text" placeholder="é …ç›®åç¨±" class="border p-2 rounded w-full">
                        <div class="grid grid-cols-2 gap-3">
                            <input id="transaction-amount" type="number" placeholder="é‡‘é¡" class="border p-2 rounded"
                                min="0" step="0.01">
                            <input id="transaction-date" type="date" class="border p-2 rounded">
                        </div>
                        <button onclick="addTransaction()"
                            class="w-full bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 btn-hover">
                            â• æ–°å¢è¨˜éŒ„
                        </button>
                    </div>

                    <!-- æ—¥æœŸç¯©é¸ -->
                    <div class="border-t pt-4 mb-4">
                        <h3 class="font-semibold mb-2">ğŸ“… æ—¥æœŸç¯©é¸</h3>
                        <div class="grid grid-cols-2 gap-2 mb-2">
                            <input id="filter-start" type="date" class="border p-2 rounded text-sm">
                            <input id="filter-end" type="date" class="border p-2 rounded text-sm">
                        </div>
                        <div class="flex gap-2">
                            <button onclick="filterTransactions()"
                                class="flex-1 bg-gray-500 text-white px-3 py-1 rounded text-sm hover:bg-gray-600">
                                ç¯©é¸
                            </button>
                            <button onclick="clearFilter()"
                                class="flex-1 bg-gray-300 text-gray-700 px-3 py-1 rounded text-sm hover:bg-gray-400">
                                æ¸…é™¤
                            </button>
                        </div>
                    </div>

                    <!-- æ•¸æ“šç®¡ç† -->
                    <div class="border-t pt-4">
                        <h3 class="font-semibold mb-2">ğŸ’¾ æ•¸æ“šç®¡ç†</h3>
                        <div class="grid grid-cols-3 gap-2">
                            <button onclick="exportData()"
                                class="bg-green-500 text-white px-3 py-2 rounded text-sm hover:bg-green-600 btn-hover">
                                åŒ¯å‡ºJSON
                            </button>
                            <button onclick="exportCSV()"
                                class="bg-green-500 text-white px-3 py-2 rounded text-sm hover:bg-green-600 btn-hover">
                                åŒ¯å‡ºCSV
                            </button>
                            <button onclick="importData()"
                                class="bg-purple-500 text-white px-3 py-2 rounded text-sm hover:bg-purple-600 btn-hover">
                                åŒ¯å…¥æ•¸æ“š
                            </button>
                        </div>
                    </div>
                </div>

                <!-- è¨˜éŒ„åˆ—è¡¨ -->
                <div class="card rounded-xl shadow-md p-6">
                    <h3 class="text-xl font-semibold mb-4">ğŸ“‹ è¨˜éŒ„åˆ—è¡¨</h3>
                    <ul id="transaction-list" class="space-y-1 max-h-96 overflow-y-auto"></ul>
                </div>
            </div>

            <!-- å¾…è¾¦èˆ‡åœ–è¡¨å€åŸŸ -->
            <div id="todo-and-charts-section" class="space-y-6">
                <!-- å¾…è¾¦äº‹é … -->
                <!-- å¾…è¾¦äº‹é …å€å¡Š -->
                <div id="todo-section">
                    <div class="card rounded-xl shadow-md p-6">
                        <h2 class="text-2xl font-semibold text-green-600 dark:text-green-400 mb-4">âœ… å¾…è¾¦äº‹é …</h2>

                        <!-- æ–°å¢ä»»å‹™è¡¨å–® -->
                        <div class="space-y-3 mb-4">
                            <input id="todo-input" type="text" placeholder="æ–°å¢ä»»å‹™..." class="border p-2 rounded w-full">
                            <div class="grid grid-cols-2 gap-3">
                                <select id="todo-priority" class="border p-2 rounded">
                                    <option value="medium">ğŸŸ¡ ä¸­å„ªå…ˆç´š</option>
                                    <option value="high">ğŸ”´ é«˜å„ªå…ˆç´š</option>
                                    <option value="low">ğŸŸ¢ ä½å„ªå…ˆç´š</option>
                                </select>
                                <input id="todo-due-date" type="date" class="border p-2 rounded">
                            </div>
                            <button onclick="addTodo()"
                                class="w-full bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 btn-hover">
                                â• æ–°å¢ä»»å‹™
                            </button>
                        </div>

                        <!-- æ’åºé¸é … -->
                        <div class="mb-4">
                            <select id="todo-sort" onchange="sortTodos()" class="border p-2 rounded w-full text-sm">
                                <option value="created">æŒ‰å‰µå»ºæ™‚é–“æ’åº</option>
                                <option value="priority">æŒ‰å„ªå…ˆç´šæ’åº</option>
                                <option value="dueDate">æŒ‰æˆªæ­¢æ—¥æœŸæ’åº</option>
                            </select>
                        </div>

                        <!-- ä»»å‹™åˆ—è¡¨ -->
                        <ul id="todo-list" class="space-y-1 max-h-80 overflow-y-auto"></ul>
                    </div>
                </div>

                <!-- åœ–è¡¨çµ±è¨ˆ -->
                <div id="charts-section">
                    <div class="card rounded-xl shadow-md p-6">
                        <h2 class="text-2xl font-semibold text-purple-600 dark:text-purple-400 mb-4">ğŸ“Š çµ±è¨ˆåœ–è¡¨</h2>

                        <!-- åœ“é¤…åœ–å€åŸŸ - ä¸¦æ’é¡¯ç¤º -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                            <div class="chart-container">
                                <canvas id="expensePieChart"></canvas>
                            </div>
                            <div class="chart-container">
                                <canvas id="incomePieChart"></canvas>
                            </div>
                        </div>

                        <!-- æŠ˜ç·šåœ–å€åŸŸ -->
                        <div class="chart-container">
                            <canvas id="lineChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- é å°¾ -->
        <footer class="text-center text-gray-500 text-sm mt-12">
            <p>ç”Ÿæ´»åŠ©æ‰‹ v2.0 | æ•¸æ“šå®‰å…¨ä¿å­˜åœ¨æ‚¨çš„ç€è¦½å™¨ä¸­</p>
        </footer>
    </div>

    <!-- å¸³æˆ¶ç®¡ç†æ¨¡æ…‹è¦–çª— -->
    <div id="account-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div
            class="card bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-6 max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-2xl font-semibold">ğŸ¦ å¸³æˆ¶ç®¡ç†</h3>
                <button onclick="closeAccountManager()" class="text-gray-500 hover:text-gray-700 text-2xl">Ã—</button>
            </div>

            <!-- æ–°å¢å¸³æˆ¶ -->
            <div class="mb-6 p-4 border rounded-lg">
                <h4 class="font-semibold mb-3">æ–°å¢å¸³æˆ¶</h4>
                <div class="grid grid-cols-2 gap-3 mb-3">
                    <input id="new-account-name" type="text" placeholder="å¸³æˆ¶åç¨±ï¼ˆä¾‹å¦‚ï¼šä¸­åœ‹ä¿¡è¨—ï¼‰" class="border p-2 rounded">
                    <select id="new-account-type" class="border p-2 rounded">
                        <option value="cash">ç¾é‡‘</option>
                        <option value="bank">éŠ€è¡Œå¸³æˆ¶</option>
                        <option value="credit">ä¿¡ç”¨å¡</option>
                    </select>
                </div>
                <button onclick="addAccount()"
                    class="w-full bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 btn-hover">
                    â• æ–°å¢å¸³æˆ¶
                </button>
            </div>

            <!-- å¸³æˆ¶åˆ—è¡¨ -->
            <div>
                <h4 class="font-semibold mb-3">ç¾æœ‰å¸³æˆ¶</h4>
                <ul id="account-list" class="space-y-2"></ul>
            </div>
        </div>
    </div>

    <!-- è½‰å¸³æ¨¡æ…‹è¦–çª— -->
    <div id="transfer-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="card bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-6 max-w-md w-full mx-4">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-2xl font-semibold">ğŸ’¸ å¸³æˆ¶è½‰å¸³</h3>
                <button onclick="closeTransferModal()" class="text-gray-500 hover:text-gray-700 text-2xl">Ã—</button>
            </div>

            <div class="space-y-3">
                <div>
                    <label class="block text-sm font-medium mb-1">å¾å¸³æˆ¶</label>
                    <select id="transfer-from" class="border p-2 rounded w-full">
                        <option value="default">ç¾é‡‘</option>
                    </select>
                </div>

                <div>
                    <label class="block text-sm font-medium mb-1">åˆ°å¸³æˆ¶</label>
                    <select id="transfer-to" class="border p-2 rounded w-full">
                        <option value="default">ç¾é‡‘</option>
                    </select>
                </div>

                <div>
                    <label class="block text-sm font-medium mb-1">è½‰å¸³é‡‘é¡</label>
                    <input id="transfer-amount" type="number" placeholder="é‡‘é¡" class="border p-2 rounded w-full" min="0"
                        step="0.01">
                </div>

                <div>
                    <label class="block text-sm font-medium mb-1">æ—¥æœŸ</label>
                    <input id="transfer-date" type="date" class="border p-2 rounded w-full">
                </div>

                <div>
                    <label class="block text-sm font-medium mb-1">å‚™è¨»ï¼ˆå¯é¸ï¼‰</label>
                    <input id="transfer-note" type="text" placeholder="ä¾‹å¦‚ï¼šææ¬¾ã€å­˜æ¬¾" class="border p-2 rounded w-full">
                </div>

                <button onclick="addTransfer()"
                    class="w-full bg-orange-500 text-white px-4 py-2 rounded hover:bg-orange-600 btn-hover mt-4">
                    âœ“ ç¢ºèªè½‰å¸³
                </button>
            </div>
        </div>
    </div>


    <!-- é¡åˆ¥ç®¡ç†æ¨¡æ…‹è¦–çª— -->
    <div id="category-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="card bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-6 max-w-2xl w-full mx-4">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-2xl font-semibold">âš™ï¸ é¡åˆ¥ç®¡ç†</h3>
                <button onclick="closeCategoryManager()"
                    class="text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 text-2xl">Ã—</button>
            </div>

            <!-- åˆ†é  -->
            <div class="flex gap-2 mb-4 border-b border-gray-200 dark:border-gray-700">
                <button id="tab-expense" onclick="switchCategoryTab('expense')"
                    class="px-4 py-2 font-semibold border-b-2 border-blue-500 text-blue-600 dark:text-blue-400">
                    æ”¯å‡ºé¡åˆ¥
                </button>
                <button id="tab-income" onclick="switchCategoryTab('income')"
                    class="px-4 py-2 font-semibold border-b-2 border-transparent text-gray-500 hover:text-gray-700 dark:hover:text-gray-300">
                    æ”¶å…¥é¡åˆ¥
                </button>
            </div>

            <!-- æ–°å¢é¡åˆ¥ -->
            <div class="mb-4 flex gap-2">
                <input id="new-category-name" type="text" placeholder="è¼¸å…¥æ–°é¡åˆ¥åç¨±"
                    class="border border-gray-300 dark:border-gray-600 p-2 rounded flex-1 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100">
                <button onclick="addCustomCategory()"
                    class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 btn-hover">
                    â• æ–°å¢
                </button>
            </div>

            <!-- é¡åˆ¥åˆ—è¡¨ -->
            <div id="category-list" class="flex flex-wrap gap-2 max-h-96 overflow-y-auto">
                <!-- å‹•æ…‹ç”Ÿæˆ -->
            </div>
        </div>
    </div>
    <script src="app.js"></script>
    <script>
        // ä¸»é¡Œåœ–æ¨™æ›´æ–°
        document.addEventListener('DOMContentLoaded', () => {
            updateThemeIcon();
        });

        function toggleTheme() {
            // ç›´æ¥å¯¦ä½œä¸»é¡Œåˆ‡æ›ï¼Œé¿å…ç„¡é™éè¿´
            const currentTheme = localStorage.getItem('theme') || 'light';
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';

            localStorage.setItem('theme', newTheme);
            document.documentElement.setAttribute('data-theme', newTheme);

            // æ›´æ–° app.js ä¸­çš„å…¨å±€ theme è®Šæ•¸ï¼ˆä½¿ç”¨ eval ä¾†æ›´æ–°æœ¬åœ°ä½œç”¨åŸŸçš„è®Šæ•¸ï¼‰
            try {
                eval(`theme = '${newTheme}';`);
            } catch (e) {
                console.warn('Could not update theme variable:', e);
            }
            window.theme = newTheme;

            // æ›´æ–°åœ–æ¨™å’ŒæŒ‰éˆ•æ–‡å­—
            updateThemeIcon();

            // é‡æ–°æ¸²æŸ“åœ–è¡¨ä»¥é©æ‡‰æ–°ä¸»é¡Œ
            if (typeof initCharts === 'function') {
                if (window.myExpensePieChart) window.myExpensePieChart.destroy();
                if (window.myIncomePieChart) window.myIncomePieChart.destroy();
                if (window.myLineChart) window.myLineChart.destroy();
                initCharts();
            }
        }

        function updateThemeIcon() {
            const icon = document.getElementById('theme-icon');
            const btn = document.getElementById('theme-toggle-btn');
            const currentTheme = document.documentElement.getAttribute('data-theme');
            icon.textContent = currentTheme === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™';
            btn.title = currentTheme === 'dark' ? 'åˆ‡æ›æˆæ·ºè‰²æ¨¡å¼' : 'åˆ‡æ›æˆæ·±è‰²æ¨¡å¼';
        }
    </script>
</body>

</html>